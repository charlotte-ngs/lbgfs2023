---
title: "Prepare Data for lbg_ex03 in LBGFS2023"
output: html_notebook
---


## Background
The problems of lbg_ex03 is based on Example 1.4 in Falconer and Mackay. From the given example, we take the genotype counts and sample a dataset.

```{r}
vec_genotype_code <- c(0:2)
vec_counts <- c(13, 39, 23)
n_nr_total_animals <- sum(vec_counts)
```

The genotypes in the dataset are encoded with `r vec_genotype_code[1]`, `r vec_genotype_code[2]` and `r vec_genotype_code[3]`. 


## Dataset
The dataset is generated by

```{r}
# n_seed <- rteachtools::get_seed();print(n_seed)
# 8659
set.seed(8659)
vec_animal_genotypes_locus_g <- sample(vec_genotype_code, size = n_nr_total_animals, prob = vec_counts/n_nr_total_animals, replace = TRUE)
```

The generated genotype codes are checked by

```{r}
table(vec_animal_genotypes_locus_g)
```

From this we can create a dataset 

```{r}
tbl_animal_genotype <- tibble::tibble(Animal = c(1:n_nr_total_animals),
                                      LocusG = vec_animal_genotypes_locus_g)

```

Generate Locus H with missing homozygocity

```{r}
vec_counts_mh <- c(1, 45, 29)
vec_animal_genotypes_locus_h <- sample(vec_genotype_code, 
                                       size = n_nr_total_animals, 
                                       prob = vec_counts/n_nr_total_animals, replace = TRUE)
tbl_animal_genotype$LocusH <- vec_animal_genotypes_locus_h
tbl_animal_genotype
```


Save the dataset to a file

```{r}
s_data_dir <- here::here("docs", "data")
s_data_file <- "lbgfs2023_lbg_ex03.csv"
s_data_path <- file.path(s_data_dir, s_data_file)
# check whether s_data_dir exists
if (!fs::dir_exists(s_data_dir)){
  fs::dir_create(s_data_dir)
}
readr::write_delim(tbl_animal_genotype, s_data_path, delim = ",")
```

